<header>
  <h1>{{tournamentName}}</h1>
  @if (showEliminationStep) {
    <div class="elimination-step">
      <h2>Select {{getTotalCount()}} Character{{(+numPlayers === 64) ? '' : 's'}} to Include</h2>
      <p>The rest of the characters will be excluded from the tournament.</p>
      
      <div class="elimination-options">
        <button 
          [class.selected]="eliminationMethod === 'random'"
          (click)="selectEliminationMethod('random')">
          Random
        </button>
        <button 
          [class.selected]="eliminationMethod === 'manual'"
          (click)="selectEliminationMethod('manual')">
          Manual
        </button>
      </div>

      <div class="character-selection-grid-wrapper">
        <div class="character-selection-grid">
          @for (char of selectableCharacters; track char.id) {
          <div 
            class="selectable-character"
            [class.selected]="isCharacterSelected(char)"
            [class.disabled]="eliminationMethod !== 'manual'"
            (click)="toggleCharacterSelection(char)">
            <img [src]="'assets/' + char.img" [alt]="char.name">
            <h3>{{char.shortName}}</h3>
          </div>
        }
        </div>
      </div>

      <div class="excluded-info">
        <strong>Characters to Include ({{getSelectedCount()}}/{{getTotalCount()}}):</strong> 
        @if (selectedCharacter1) {
          <span>{{selectedCharacter1.name}}</span>
        }
        @if (selectedCharacter1 && selectedCharacter2) {
          <span>, </span>
        }
        @if (selectedCharacter2) {
          <span>{{selectedCharacter2.name}}</span>
        }
        @if (!selectedCharacter1 && !selectedCharacter2) {
          <span class="hint">Select {{getTotalCount()}} character{{(+numPlayers === 64) ? '' : 's'}} to include</span>
        }
      </div>

      <button (click)="confirmEliminations()" class="confirm-btn">Start Tournament</button>
    </div>
  } @else if (tournamentCreated) {
    <app-tournament-bracket 
      [bracketSize]="numPlayers"
      [includedIds]="includedCharacterIds">
    </app-tournament-bracket>
  } @else {
    <form>
      <div>
        <label for="tournament-name">Tournament Name:</label>
        <input type="text" id="tournament-name" name="tournament-name" [(ngModel)]="tournamentName">
      </div>
      <div>
        <label for="num-players">Number of Players:</label>
        <select id="num-players" name="num-players" [(ngModel)]="numPlayers">
          <option value="8">8</option>
          <option value="16">16</option>
          <option value="32">32</option>
          <option value="64">64</option>
        </select>
      </div>
      <div>
        @switch (+numPlayers) {
          @case (8) {
            A small tournament
          }
          @case (16) {
            A medium-sized tournament
          }
          @case (32) {
            A large tournament
          }
          @case (64) {
            A massive tournament
          }
          @default {
            {{numPlayers}} characters
          }
        }
      </div>
      <button (click)="createBracket()">Create Bracket</button>
    </form>
  }
  
  <app-back-button></app-back-button>
</header>
